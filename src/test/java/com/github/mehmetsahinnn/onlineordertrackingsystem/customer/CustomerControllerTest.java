package com.github.mehmetsahinnn.onlineordertrackingsystem.customer;import com.github.mehmetsahinnn.onlineordertrackingsystem.security.PCrypt;import org.junit.jupiter.api.BeforeEach;import org.junit.jupiter.api.Test;import org.mockito.InjectMocks;import org.mockito.Mock;import org.mockito.MockitoAnnotations;import org.springframework.http.HttpStatus;import org.springframework.http.ResponseEntity;import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;import java.util.Collections;import java.util.List;import static org.junit.jupiter.api.Assertions.assertEquals;import static org.junit.jupiter.api.Assertions.assertNull;import static org.mockito.ArgumentMatchers.anyString;import static org.mockito.Mockito.*;/** * Unit tests for the CustomerController class. */class CustomerControllerTest {    @Mock    private CustomerService customerService;    @Mock    private PCrypt crypt;    @InjectMocks    private CustomerController customerController;    /**     * Initializes Mockito annotations before each test method.     */    @BeforeEach    public void init() {        try (AutoCloseable ac = MockitoAnnotations.openMocks(this)) {            Customer customer = new Customer();            when(customerService.getCurrentUser()).thenReturn(customer);        } catch (Exception e) {            throw new RuntimeException(e);        }    }    /**     * Tests the login method of CustomerController with valid credentials.     * Verifies that the response status is OK and the customer object is returned.     */    @Test    public void testLoginValidCredentials() {        Customer customer = new Customer(1L, "msa", "hin", "password", "john.doe@example.com", false);        when(customerService.findByEmail(anyString())).thenReturn(customer);        BCryptPasswordEncoder bCryptPasswordEncoder = mock(BCryptPasswordEncoder.class);        when(crypt.passwordEncoder()).thenReturn(bCryptPasswordEncoder);        when(bCryptPasswordEncoder.matches(anyString(), anyString())).thenReturn(true);        ResponseEntity<?> responseEntity = customerController.login(customer);        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());        assertEquals(customer, responseEntity.getBody());    }    /**     * Tests the login method of CustomerController with invalid credentials.     * Verifies that the response status is UNAUTHORIZED and the appropriate message is returned.     */    @Test    public void testLoginInvalidCredentials() {        when(customerService.findByEmail(anyString())).thenReturn(null);        ResponseEntity<?> responseEntity = customerController.login(new Customer(1L,"msa","hin","password","john.doess@example.com",false));        assertEquals(HttpStatus.UNAUTHORIZED, responseEntity.getStatusCode());        assertEquals("Invalid email or password", responseEntity.getBody());    }    /**     * Tests the registerUser method of CustomerController when registration is successful.     * Verifies that the response status is OK and the registration process is invoked.     */    @Test    public void testRegisterUserSuccess() {        Customer customer = new Customer(/* add necessary parameters */);        doNothing().when(customerService).registerNewCustomer(customer);        ResponseEntity<?> responseEntity = customerController.registerUser(customer);        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());        verify(customerService, times(1)).registerNewCustomer(customer);    }    /**     * Tests the registerUser method of CustomerController when user already exists.     * Verifies that the response status is CONFLICT and the appropriate message is returned.     */    @Test    public void testRegisterUserAlreadyExists() {        Customer customer = new Customer();        doThrow(new RuntimeException("User Already Exists !")).when(customerService).registerNewCustomer(customer);        ResponseEntity<?> responseEntity = customerController.registerUser(customer);        assertEquals(HttpStatus.CONFLICT, responseEntity.getStatusCode());        assertEquals("User Already Exists !", responseEntity.getBody());    }    /**     * Tests the listCustomers method of CustomerController when listing customers is successful.     * Verifies that the response status is OK and the list of customers is returned.     */    @Test    public void testListCustomers_Success() {        List<Customer> customers = Collections.singletonList(new Customer(1L,"msa","hin","password","josh.doe@example.com",false));        when(customerService.findAll()).thenReturn(customers);        ResponseEntity<?> responseEntity = customerController.listCustomers();        assertEquals(HttpStatus.OK, responseEntity.getStatusCode());        assertEquals(customers, responseEntity.getBody());    }    /**     * Tests the deleteById method of CustomerController.     * Verifies that the response status is NO_CONTENT after successfully deleting a customer.     */    @Test    public void testDeleteCustomer(){        Customer customer = new Customer();        customer.setId(1L);        customer.setName("Jack");        customer.setSurname("Names");        ResponseEntity<?> response = customerController.deleteById(customer.getId());        assertEquals(HttpStatus.NO_CONTENT, response.getStatusCode());        assertNull(response.getBody());    }}